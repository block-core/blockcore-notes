<span *ngIf="eventsView$ | async as events">
  <mat-progress-bar *ngIf="events == null" mode="indeterminate"></mat-progress-bar>

  <div class="page loading-container" *ngIf="!profileService.initialized">
    We'll be right ready for you... wait a second or two.<br /><br /><br />
    <mat-spinner class="loading"></mat-spinner>
  </div>

  <div class="page loading-container" *ngIf="profileService.initialized && events.length === 0 && hasFollowers">
    Updating the user profiles and getting their recent notes... wait a few seconds.<br /><br /><br />
    <mat-spinner class="loading"></mat-spinner>
  </div>

  <div class="feed-page" *ngIf="events.length > 0">
    <!-- <mat-accordion class="options">
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>Options</mat-panel-title>
          <mat-panel-description>{{ activeOptions() }}</mat-panel-description>
        </mat-expansion-panel-header>
        <p>
          <mat-slide-toggle class="options-slider" [(ngModel)]="options.options.flatfeed" (ngModelChange)="optionsUpdated()">Flat Feed (turn off threads)</mat-slide-toggle>
          <mat-slide-toggle class="options-slider" [(ngModel)]="options.options.ascending" (ngModelChange)="optionsUpdated()">Oldest first</mat-slide-toggle>
          <mat-slide-toggle class="options-slider" [(ngModel)]="options.options.paused">Pause feed</mat-slide-toggle>
          <mat-slide-toggle class="options-slider" [(ngModel)]="options.options.hideSpam" (ngModelChange)="optionsUpdated()">Hide spam</mat-slide-toggle>
          <mat-slide-toggle class="options-slider" [(ngModel)]="options.options.hideInvoice" (ngModelChange)="optionsUpdated()">Hide LN invoices</mat-slide-toggle>
        </p>
      </mat-expansion-panel>
    </mat-accordion> -->

    <mat-card class="events clickable" (click)="navigation.openEvent($event, event)" *ngFor="let event of events; trackBy: trackByFn">
      <div class="events-header">
        <app-event-header [pubkey]="event.pubkey"
          ><span class="event-date" matTooltipPosition="below">{{ event.created_at | ago }}</span> <app-directory-icon [pubkey]="event.pubkey"></app-directory-icon
        ></app-event-header>
        <app-event-actions [event]="event"></app-event-actions>
      </div>
      <app-content [event]="event"></app-content>
      <!-- {{ event.content }}<span *ngIf="event.contentCut">... (message was truncated)</span> -->

      <!-- <div *ngIf="details">
          <br />
          <span *ngFor="let tag of event.tags" class="dimmed">TAG: {{ tag }}</span>
        </div> -->
      <!-- <button *ngIf="!details" class="expand-button" mat-icon-button (click)="toggleDetails()">
        <mat-icon class="expand-button-icon">expand_more</mat-icon>
      </button>
      <button *ngIf="details" class="expand-button" mat-icon-button (click)="toggleDetails()">
        <mat-icon class="expand-button-icon">expand_less</mat-icon>
      </button> -->
    </mat-card>

    <div class="show-more centered">
      <button mat-button (click)="showMore()">Show more...</button>
    </div>
  </div>
</span>
